
<!doctype html>
<html lang="ja" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="MocapForAllの公式ドキュメント。MocapForAllは、複数のWebカメラで人間の動きをキャプチャするWindowsアプリです。セットアップ方法、SteamVRやゲームエンジン等と組み合わせて使用する方法等について説明しています。">
      
      
      
        <meta name="author" content="Kenji Asaba">
      
      
        <link rel="canonical" href="https://Akiya-Research-Institute.github.io/testmkdoc/%E3%83%9E%E3%83%8B%E3%83%A5%E3%82%A2%E3%83%AB/">
      
      <link rel="icon" href="../images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.6">
    
    
      
        <title>マニュアル - MocapForAll マニュアル</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.a57b2b03.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=M+PLUS+1:300,400,400i,700%7CM+PLUS+1+Code&display=fallback">
        <style>:root{--md-text-font-family:"M PLUS 1";--md-code-font-family:"M PLUS 1 Code"}</style>
      
    
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    
      

  


  

  


  <script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-2709176-10","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
  <script async src="https://www.google-analytics.com/analytics.js"></script>


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          コンテンツにスキップ
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="ヘッダー">
    <a href=".." title="MocapForAll マニュアル" class="md-header__button md-logo" aria-label="MocapForAll マニュアル" data-md-component="logo">
      
  <img src="../images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MocapForAll マニュアル
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              マニュアル
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_4" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_3">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_4">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_3" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31z"/></svg>
            </label>
          
        
      </form>
    
    
      <div class="md-header__option">
        <div class="md-select">
          
          <button class="md-header__button md-icon" aria-label="Select language">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24z"/></svg>
          </button>
          <div class="md-select__inner">
            <ul class="md-select__list">
              
                <li class="md-select__item">
                  <a href="/testmkdoc/en/" hreflang="en" class="md-select__link">
                    English
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="/testmkdoc/ja/" hreflang="ja" class="md-select__link">
                    日本語
                  </a>
                </li>
                
            </ul>
          </div>
        </div>
      </div>
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="検索" placeholder="検索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" aria-label="クリア" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            検索を初期化
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="ナビゲーション" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="MocapForAll マニュアル" class="md-nav__button md-logo" aria-label="MocapForAll マニュアル" data-md-component="logo">
      
  <img src="../images/logo.png" alt="logo">

    </a>
    MocapForAll マニュアル
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        MocapForAllって何？
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          インストール方法
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="インストール方法" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          インストール方法
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how-to-install/install-mocapforall/" class="md-nav__link">
        MocapForAllのインストール方法
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how-to-install/install-tensorrt/" class="md-nav__link">
        TensorRTのインストール
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          キャプチャ方法
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="キャプチャ方法" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          キャプチャ方法
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how-to-capture/get-cameras/" class="md-nav__link">
        カメラの用意
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_2">
          カメラ校正
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="カメラ校正" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          カメラ校正
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how-to-capture/calibrate-cameras/what-is-camera-calibration/" class="md-nav__link">
        カメラ校正とは？
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how-to-capture/calibrate-cameras/prepare-markers/" class="md-nav__link">
        マーカの準備
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how-to-capture/calibrate-cameras/connect-cameras/" class="md-nav__link">
        カメラの接続
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how-to-capture/calibrate-cameras/execute-calibration/" class="md-nav__link">
        カメラ校正の実施
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_3">
          設定の調整
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="設定の調整" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          設定の調整
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how-to-capture/adjust-settings/adjust-scales/" class="md-nav__link">
        Adjust scales
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how-to-capture/adjust-settings/adjust-animation/" class="md-nav__link">
        Adjust animation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how-to-capture/adjust-settings/optimize-performance/" class="md-nav__link">
        Optimize performance
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          エクスポート方法
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="エクスポート方法" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          エクスポート方法
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how-to-export/to-steamvr/" class="md-nav__link">
        Export to SteamVR
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how-to-export/to-game-engines/" class="md-nav__link">
        Export to game engines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how-to-export/to-vmc-marionette/" class="md-nav__link">
        Export to VMC marionette
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how-to-export/to-bvh-files/" class="md-nav__link">
        Export to BVH files
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how-to-export/to-shared-memory/" class="md-nav__link">
        Export to shared memory
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          その他の設定
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="その他の設定" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          その他の設定
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../other-settings/capture-hand-and-face/" class="md-nav__link">
        Capture hand and face
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../other-settings/capture-from-recorded-video/" class="md-nav__link">
        Capture from recorded video
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../other-settings/" class="md-nav__link">
        Others
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h4 id="_1">内部パラメータの取得で使う画像の印刷</h4>
<p><a href="https://raw.githubusercontent.com/Akiya-Research-Institute/MocapForAll-Wiki/main/resources/calibration/IntrinsicCalibration.png">この画像</a>を使います。<br />
まだカメラを部屋の中で固定していない場合は、印刷は不要です。この画像をPCのディスプレイに表示して使います。<br />
すでにカメラを固定済みの場合は、上記の画像をA4程度の大きさで印刷してください。大きさは厳密である必要はありません。ダンボールなどに貼り付けて平面の状態を保てるようにしておいてください。<br />
<img alt="Camera-Calibration-Intrinsic-Marker" src="{{ site.url }}{{ site.baseurl }}/assets/images/Camera-Calibration-Intrinsic-Marker.jpg" />  </p>
<h4 id="_2">外部パラメータの取得で使う画像の印刷</h4>
<p>先に説明した<a href="#外部パラメータの取得の4つの方式">外部パラメータの取得の4つの方式</a>により、使用する画像が異なります。</p>
<ol>
<li>ChArUcoボードを使うやり方<br />
<a href="https://raw.githubusercontent.com/Akiya-Research-Institute/MocapForAll-Wiki/main/resources/calibration/ExtrinsicCalibration.png">この画像</a>を使います。これを<strong>できればA2以上</strong>のサイズで印刷してください。<br />
「A2で印刷できるプリンタがない！」という場合（私もです）、画像を二つにわけてA3用紙2枚に印刷し、テープでくっつけるのがおすすめです。<br />
<img alt="Camera-Calibration-Extrinsic-Marker-Charuco" src="{{ site.url }}{{ site.baseurl }}/assets/images/Camera-Calibration-Extrinsic-Marker-Charuco.jpg" /><br />
このようにダンボールなどに貼り付け、きれいな平面の状態を保てるようにしておくと、後々まで使い続けることができます。<br />
（上の写真のものは3か月ほど使い込んでいますが、現役です)</li>
<li>ArUcoクラスターを使うやり方<br />
<a href="https://github.com/Akiya-Research-Institute/MocapForAll-Wiki/raw/main/resources/calibration/ArucoMarkers.zip">このzip</a>にある"ArucoMarker0.png"と"同1"、"同2"を使います。これをA4かA3サイズで印刷してください。それほど広くない部屋ならA4で十分です。<br />
<img alt="Camera-Calibration-Extrinsic-Marker-Aruco" src="{{ site.url }}{{ site.baseurl }}/assets/images/Camera-Calibration-Extrinsic-Marker-Aruco.jpg" />  </li>
<li>Diamondクラスターを使うやり方<br />
<a href="https://github.com/Akiya-Research-Institute/MocapForAll-Wiki/raw/main/resources/calibration/DiamondMarkers.zip">このzip</a>にある"diamondMarker0.png"およびそれ以降を使います。「1.ChArUcoボードを使うやり方」と同様に、A2以上のサイズで印刷してください。 <img alt="Camera-Calibration-Extrinsic-Marker-Diamond" src="{{ site.url }}{{ site.baseurl }}/assets/images/Camera-Calibration-Extrinsic-Marker-Diamond.jpg" /></li>
<li>人の動きを使うやり方<br />
    特に準備するものはありません。</li>
</ol>
<h3 id="2">カメラ校正の準備2：マーカのサイズの計測</h3>
<p>外部パラメータの取得で使う画像については、実際に印刷された画像のサイズを測る必要があります。これがキャプチャされた動きのスケールの基準になります。<br />
先に説明した<a href="#外部パラメータの取得の4つの方式">外部パラメータの取得の4つの方式</a>により、下記の通り計測する箇所が異なります。  </p>
<ol>
<li>
<p>ChArUcoボードを使うやり方<br />
<img alt="Which_side_to_measure_-_ChArUco_board" src="{{ site.url }}{{ site.baseurl }}/assets/images/Which_side_to_measure_-_ChArUco_board_(default).png" /> <br />
上記の赤矢印の長さを測ります。計測結果をMocapForAllの「Settings &gt; Calibration &gt; Maker size (affects to coord. scale) &gt; <strong>ChArUco board</strong> [m]」に入力します。単位はメートルです。<br />
<img alt="Which_side_to_measure_-_ChArUco_board" src="{{ site.url }}{{ site.baseurl }}/assets/images/Settings-Calibration.png" />   </p>
</li>
<li>
<p>ArUcoクラスターを使うやり方<br />
<img alt="Which_side_to_measure_-_ArUco_marker" src="{{ site.url }}{{ site.baseurl }}/assets/images/Which_side_to_measure_-_ArUco_marker.png" /><br />
上記の赤矢印の長さを測ります。計測結果をMocapForAllの「Settings &gt; Calibration &gt; Maker size (affects to coord. scale) &gt; <strong>ArUco marker</strong> [m]」に入力します。単位はメートルです。</p>
</li>
<li>
<p>Diamondクラスターを使うやり方<br />
<img alt="Which_side_to_measure_-_Diamond_marker" src="{{ site.url }}{{ site.baseurl }}/assets/images/Which_side_to_measure_-_Diamond_marker.png" /><br />
上記の赤矢印の長さを測ります。計測結果をMocapForAllの「Settings &gt; Calibration &gt; Maker size (affects to coord. scale) &gt; <strong>Diamond marker</strong> [m]」に入力します。単位はメートルです。</p>
</li>
<li>
<p>人の動きを使うやり方<br />
自身の身長を測ります。計測結果をMocapForAllの「Settings &gt; Calibration &gt; Maker size (affects to coord. scale) &gt; <strong>Human hight</strong> [m]」に入力します。単位はメートルです。</p>
</li>
</ol>
<h3 id="_3">カメラの接続</h3>
<p>少なくとも2台のカメラをPCに接続します。<br />
MocapForAllのウィンドウ上部の「Add camera」ボタンを使用するカメラの数だけクリックします。<br />
「Camera:」の横のプルダウンボックスを選択し、接続したカメラを探します。 <br />
<img alt="Camera-Add" src="{{ site.url }}{{ site.baseurl }}/assets/images/Camera-Add.gif" /></p>
<p>「Image size」横のボックスにサイズを入力し「Apply」をクリックすると、カメラの画像サイズを変更できます。（カメラが指定された画像サイズをサポートしている必要があります。）
カメラの画像サイズの変更に失敗することがありますが、その場合はカメラを閉じてから少し待って、再度お試しください。</p>
<p>画像の左右反転ができます。一部のカメラはデフォルトで画像が鏡像になっていることに注意してください。画像が鏡像になっているとARマーカが読み込めません。</p>
<p>画像の回転ができます。キャプチャ開始時点は人が真っすぐ立っている画像でなければ認識できないので、カメラの設置状況に合わせて画像を適切に回転しておいてください。</p>
<h4 id="_4">カメラ制御フレームワークの選択</h4>
<p>MocapForAllのウィンドウ上部の「Add camera」の横の「▼」を押すと、カメラの制御に使うフレームワークを選択できます。    </p>
<p><img alt="Camera-Add-Framework" src="{{ site.url }}{{ site.baseurl }}/assets/images/Camera-Add-Framework.png" /></p>
<ul>
<li><strong>Direct show:</strong> Microsoftのメディアフレームワーク。OBS-VirtualCamプラグインが使えます。</li>
<li><strong>UE4 media player:</strong> UE4のメディアフレームワーク。高解像度での性能に優れています。一部のカメラは動作しないようです。</li>
<li><strong>Recorded video</strong>: カメラの代わりに録画済みの動画を使用します。詳細は、<a href="#録画した動画からモーションキャプチャする">録画した動画からモーションキャプチャする</a>を参照してください。</li>
</ul>
<p>UE4 media playerで動作するカメラならば、そちらがおすすめです。動作しない場合はDirect Showを使いましょう。</p>
<h3 id="_5">内部パラメータのカメラ校正手順</h3>
<p><a href="#内部パラメータの取得で使う画像の印刷">内部パラメータの取得で使う画像の印刷</a>で画像を印刷していない場合は、<a href="https://raw.githubusercontent.com/Akiya-Research-Institute/MocapForAll-Wiki/main/resources/calibration/IntrinsicCalibration.png">この画像</a>を任意のアプリで画面にできるだけ大きく表示します。</p>
<p>MocapForAllで「Camera &gt; Calibration &gt; Intrinsic」の下の「Start」ボタンをクリックします。<br />
10秒間程度、さまざまな角度からカメラで画像を写してください。カメラを固定済みの場合は、カメラでなく画像の方を動かします。<br />
カメラ校正が完了すると、アプリの画面上に内部パラメータが表示され、「Intrinsic  ☑Calibrated」となります。</p>
<!-- ![Camera-Calibration-Intrinsic-Execution]({{ site.url }}{{ site.baseurl }}/assets/images/Camera-Calibration-Intrinsic-Execution.gif)　 -->
<p><img alt="" loading="lazy" src="../images/Camera-Calibration-Intrinsic-Execution.gif" /></p>
<p>完了したら「Save」からカメラ校正結果を保存しておきます。</p>
<h3 id="_6">外部パラメータのカメラ校正手順</h3>
<p>先に説明した<a href="#外部パラメータの取得の4つの方式">外部パラメータの取得の4つの方式</a>により、手順が異なります。</p>
<ol>
<li>
<p>ChArUcoボードを使うやり方<br />
<a href="#外部パラメータの取得で使う画像の印刷">外部パラメータの取得で使う画像の印刷</a>で印刷した画像を床に置きます。これがモーションキャプチャの原点になります。<br />
    床に置いた画像が見える場所にカメラを設置します。  </p>
<p>MocapForAllで「Settings &gt; Calibration &gt; Extrinsic calibration method」で「<strong>ChArUco board (default)</strong>」を選択します。
「Camera &gt; Calibration &gt; Extrinsic」の下の「Start」ボタンをクリックします。キャリブレーションが完了すると、外部パラメータが表示され、「Extrinsic  ☑Calibrated」となります。</p>
<p>マーカの読み取りがうまく実施できない場合は、<a href="#マーカをうまく読み取れない場合">マーカをうまく読み取れない場合</a>を試してみてください。</p>
<p><!-- <img alt="Camera-Calibration-Extrinsic-Execution-Charuco" src="{{ site.url }}{{ site.baseurl }}/assets/images/Camera-Calibration-Extrinsic-Execution-Charuco.gif" /> -->
<img alt="" loading="lazy" src="../images/Camera-Calibration-Extrinsic-Execution-Charuco.gif" /></p>
</li>
<li>
<p>ArUcoクラスターを使う方法<br />
<a href="#外部パラメータの取得で使う画像の印刷">外部パラメータの取得で使う画像の印刷</a>で印刷した画像を床に置きます。「arucoMarker0.png」がモーションキャプチャの原点になります。<br />
    床に置いた画像が見える場所にカメラを設置します。  </p>
<p>MocapForAllで「Settings &gt; Calibration &gt; Extrinsic calibration method」で「<strong>ArUco cluster</strong>」を選択します。
「Camera &gt; Calibration &gt; Extrinsic」の下の「Scan markers」ボタンをクリックします。マーカの位置関係がスキャンされ、しばらくすると3Dビューポート上にマーカが表示されます。</p>
<p>マーカがスキャンできたら「Stop scanning」をクリックし、次に「Start」ボタンをクリックします。キャリブレーションが完了すると、外部パラメータが表示され、「Extrinsic  ☑Calibrated」となります。  </p>
<p>マーカの読み取りがうまく実施できない場合は、<a href="#マーカをうまく読み取れない場合">マーカをうまく読み取れない場合</a>を試してみてください。</p>
<p><!-- <img alt="Camera-Calibration-Extrinsic-Execution-Aruco" src="{{ site.url }}{{ site.baseurl }}/assets/images/Camera-Calibration-Extrinsic-Execution-Aruco.gif" /> -->
<img alt="" loading="lazy" src="../images/Camera-Calibration-Extrinsic-Execution-Aruco.gif" /></p>
</li>
<li>
<p>Diamondクラスターを使う方法<br />
<a href="#外部パラメータの取得で使う画像の印刷">外部パラメータの取得で使う画像の印刷</a>で印刷した画像を、カメラのフレームに収まる程度の距離をおいて配置します。同一平面内にある必要はありません。「diamondMarker0.png」がモーションキャプチャの原点になるので、これは床面に置きます。</p>
<p>MocapForAllで「Settings &gt; Calibration &gt; Extrinsic calibration method」で「<strong>Diamond cluster</strong>」を選択します。</p>
<p>任意のカメラの一つで「Camera &gt; Calibration &gt; Extrinsic」の下の「Scan markers」ボタンをクリックします。そのカメラで、「diamondMarker0.png」を映します。次に「diamondMarker0.png」といずれかのマーカを同時に映してしばらくその状態を維持します。しばらくすると「diamondMarker0.png」を原点としてもう一つのマーカの位置が確定し、当該マーカが3Dビューポート上に表示されます。</p>
<p>位置が確定済みのマーカと位置が未確定のマーカについて、上記の作業を繰り返し、全マーカの位置が確定したら「Stop scanning」をクリックします。</p>
<p>位置が確定済みのマーカが映る位置にカメラを設置し、「Camera &gt; Calibration &gt; Extrinsic」の下の「Start」ボタンをクリックします。キャリブレーションが完了すると、外部パラメータが表示され、「Extrinsic  ☑Calibrated」となります。  </p>
<p><!-- <img alt="Camera-Calibration-Extrinsic-Execution-Diamond" src="{{ site.url }}{{ site.baseurl }}/assets/images/Camera-Calibration-Extrinsic-Execution-Diamond.gif" /> -->
<img alt="" loading="lazy" src="../images/Camera-Calibration-Extrinsic-Execution-Diamond.gif" /></p>
</li>
<li>
<p>体の動きを使う方法<br />
    少なくとも二つのカメラが同時に人を映せるようにカメラを設置します。</p>
<p>MocapForAllで「Settings &gt; Calibration &gt; Extrinsic calibration method」で「<strong>Human motion</strong>」を選択します。<br />
また、ハードウェアが対応していれば、「Settings &gt; General &gt; Run DNN on」を「<strong>GPU_DirectML</strong>」にします。（AppendixのTensorRTモードをインストール済みの場合は「GPU_TensorRT」でもOKです）<br />
ハードウェアの性能が許せば、「Settings &gt; General &gt; Capture body」を「<strong>Speed</strong>」に設定します。（AppendixのPrecisionモードをインストール済みの場合は「Precision」でもOKです）</p>
<p><strong>ウィンドウ上部の「Start calibration」ボタン</strong>をクリックし、全身がカメラに映る場所を歩き回ってください。<br />
カメラに同時に映る人体の関節位置からカメラの相対位置が決定され、一つ目のカメラを基準にして外部パラメータが決定されます。全カメラの外部パラメータが決定され、「Extrinsic ☑Calibrated」となります。  </p>
<p>最後に、次に説明する<a href="#マーカをうまく読み取れない場合">マーカをうまく読み取れない場合</a>と同じように、ウィンドウ上部の「Find Ground」ボタンをクリックして適当に歩きまわり、カメラの絶対位置を決定します。</p>
<p><!-- <img alt="Camera-Calibration-Extrinsic-Execution-Human" src="{{ site.url }}{{ site.baseurl }}/assets/images/Camera-Calibration-Extrinsic-Execution-Human.gif" /> -->
<img alt="" loading="lazy" src="../images/Camera-Calibration-Extrinsic-Execution-Human.gif" /></p>
</li>
</ol>
<h4 id="_7">マーカをうまく読み取れない場合</h4>
<p>マーカの位置がキャプチャ結果の高さゼロの面となるため、基本的にマーカは床に置くことを推奨していますが、カメラの性能や配置によっては床においたマーカを読み取ることが難しい場合があります。</p>
<p>そのような場合、<strong>マーカを壁に掛けてカメラ校正を行い、床面の位置はあとから調整</strong>することができます。</p>
<p>手順：
- 印刷した画像を「床に置き」となっているところを「<strong>適当な壁に掛け</strong>」に読み替えてカメラ校正を実施します。
- ハードウェアが対応していれば、「Settings &gt; General &gt; Run DNN on」を「<strong>GPU_DirectML</strong>」にします。（AppendixのTensorRTモードをインストール済みの場合は「GPU_TensorRT」でもOKです）<br />
  ハードウェアの性能が許せば、「Settings &gt; General &gt; Capture body」を「<strong>Speed</strong>」に設定します。（AppendixのPrecisionモードをインストール済みの場合は「Precision」でもOKです）
- ウィンドウ上部の「<strong>Find Ground</strong>」をクリックし、全身が複数のカメラに映る場所を歩き回ります。しばらくすると、自動的に床面の位置が調整されます。</p>
<!-- ![Camera-Calibration-Extrinsic-Execution-FindGround]({{ site.url }}{{ site.baseurl }}/assets/images/Camera-Calibration-Extrinsic-Execution-FindGround.gif) -->
<p><img alt="" loading="lazy" src="../images/Camera-Calibration-Extrinsic-Execution-FindGround.gif" /></p>
<h4 id="_8">カメラ校正結果の確認</h4>
<p><a href="#カメラ校正の準備2：マーカのサイズの計測">カメラ校正の準備2：マーカのサイズの計測</a>で正しい値を入力していれば、3Dビューポート上でカメラの位置を確認できます。視点の移動方法は、<a href="#視点の移動">視点の移動</a>を参照してください。</p>
<p>カメラが床より下の位置に表示される場合がある可能性があることに注意してください。（この場合、カメラ校正が失敗しています）</p>
<h3 id="_9">カメラ校正結果の保存と読み込み</h3>
<p>カメラ校正が完了したら、「Camera &gt; Calibration &gt; Intrinsic」と「Extrinsic」の下の「Save」から、各カメラの校正結果を保存しておきます。保存した結果は「Load」から読み込むことができます。</p>
<p>また、ウィンドウ上部の「Save All Cameras」ボタンと「Load All Cameras」ボタンをクリックして、カメラ設定全体を保存およびロードできます。
「Save All Cameras」では、カメラの選択はプルダウン内の何番目かという情報で保存されることに注意してください。 PCからカメラを取り外すと、プルダウン内のカメラの順序が変わり、カメラを正しくロードできなくなります。</p>
<p><img alt="Camera-Calibration-Save" src="{{ site.url }}{{ site.baseurl }}/assets/images/Camera-Calibration-Save.gif" />
<img alt="" loading="lazy" src="../images/.gif" /></p>
<h2 id="_10">アプリ上での調整</h2>
<p>前節までの作業に加え、アプリ上でいくつかのパラメータを調整する必要があります。</p>
<h3 id="_11">視点の移動</h3>
<p>これ以降の操作を行う前提として、MocapForAll上で視点を移動するには、WASDキーとマウスのドラッグを使用します。
また、画面の最大化は、F11キーでオンオフできます。</p>
<p><img src="{{ site.url }}{{ site.baseurl }}/assets/images/App-wasd.png" alt="App-wasd" style="zoom:50%;" />　</p>
<h3 id="_12">スケールの調整</h3>
<p><img alt="Settings-Coordinates-Scales" src="{{ site.url }}{{ site.baseurl }}/assets/images/Settings-Coordinates-Scales.png" /> </p>
<p>ウィンドウ上部の「Start capture」をクリックし、二つ以上のカメラに全身を映すと、モーションがキャプチャされます。
キャプチャ結果を観察し、下記の通りスケールを適切に調整することで、キャラクターに動きが正しく反映されるようにしていきます。　</p>
<p>Virtual Motion TrackerおよびVRアプリと組み合わせて使用する場合は、後述の<a href="#steamvrとmocapforallの座標合わせ">SteamVRとMocapForAllの座標合わせ</a>でスケールも併せて調整するので、ここでの調整は適当でOKです。</p>
<p>なお、上半身と下半身でスケールを分けているのは、2次元のキャラクターは一般に生身の人間より足が長いので、上半身と下半身を分けないと生身の人間のサイズと合わないからです。（そのため、上半身と下半身のスケールの比は適用したいキャラクターに依存します）</p>
<h4 id="_13">下半身のスケール</h4>
<p>腰、股関節、膝、足の位置に影響します。また、体全体の位置（root位置）もこのスケールに従います。</p>
<ul>
<li>キャラクターが常にしゃがんでいる場合： 「Settings &gt; Coordinates &gt; Scale &gt; Lower body」の値を増やします。</li>
<li>キャラクターが宙に浮いている場合： 「Settings &gt; Coordinates &gt; Scale &gt; Lower body」の値を減らします。</li>
</ul>
<h4 id="_14">上半身のスケール</h4>
<p>胸、首、頭、肩、肘、手、指の位置に影響します。</p>
<ul>
<li>キャラクターの肩が常に下を向いている場合： 「Settings &gt; Coordinates &gt; Scale &gt; Upper body」の値を増やします。</li>
<li>キャラクターの肩が常に上を向いている場合： 「Settings &gt; Coordinates &gt; Scale &gt; Upper body」の値を減らします。</li>
</ul>
<h3 id="_15">動きの加工の調整</h3>
<p><img alt="Settings-AnimationPostProcess" src="{{ site.url }}{{ site.baseurl }}/assets/images/Settings-AnimationPostProcess.png" /> </p>
<p>キャプチャされた動きは、下記の加工がされたうえで画面に表示されます。好みに応じてそれらの調整を行います。　</p>
<h4 id="_16">足の強制接地のオンオフ</h4>
<p>足が地面にめり込んだり、地面から浮いたりしてしまわないよう、足が地面の近くにある場合はその位置を自動的に調整する機能があります。</p>
<ul>
<li><strong>足の接地感を重視</strong>する場合は、「Settings &gt; Animation Post Process &gt; Force feet grouded」を<strong>オン</strong>にして上記機能を使用することをおすすめします。</li>
<li><strong>脚全体の動きを重視</strong>する場合は、「Settings &gt; Animation Post Process &gt; Force feet grouded」を<strong>オフ</strong>にして上記機能を使用しないことをおすすめします。</li>
</ul>
<p>なお、「Settings &gt; Data export &gt; VMT protocol &gt; Send tracking points」をオンにしたときに送信されるデータは、上記の位置調整が適用される前のものです。（つまり、<strong>VMTでVRアプリと組み合わせて使用する場合は、ここでの設定は関係ありません</strong>）
上記以外の外部送信データは、上記の位置調整が適用された後のものです。</p>
<p>足がどれくらい地面に近い場合にこの位置調整が適用されるかは、「Settings &gt; Coordinates &gt; Scale &gt; Lower body」に応じて自動的に設定されます。
<a href="#カメラ校正の準備2：マーカのサイズの計測">カメラ校正の準備2：マーカのサイズの計測</a>が適切に行われず、上記「Lower body」に大きな値を設定してしまっていると、足が全く地面から離れなくなることがあります。その場合は、<a href="#カメラ校正の準備2：マーカのサイズの計測">カメラ校正の準備2：マーカのサイズの計測</a>と<a href="#外部パラメータのカメラ校正手順">外部パラメータのカメラ校正</a>を再度実施するか、「Force feet grouded」をオフにしてください。</p>
<h4 id="_17">スムージングの調整</h4>
<p>キャプチャした動きを、時系列に沿ってスムージングする機能があります。
外部送信できる各種データは、全てこのスムージングが適用された後のものです。</p>
<h5 id="_18">スムージングのオンオフ</h5>
<p>通常オンの状態で使用しますが、キャプチャ結果を利用するアプリケーションで独自にスムージングを行う場合は、MocapForAll側でのスムージングをオフにすることがあります。
「Settings &gt; Animation Post Process &gt; Smoothing on body」および「Smoothing on finger」「Smoothing on facial expression」で、体、指、表情へのスムージングのオンオフを設定できます。</p>
<h5 id="_19">スムージングの強度の変更</h5>
<p>スムージングの強度を変更することもできます。</p>
<h6 id="_20">スムージングのしくみ</h6>
<p>スムージングには<a href="http://cristal.univ-lille.fr/~casiez/1euro/">1€フィルタ</a>を使用しています。1€フィルタとは、端的に表現すると「速さに比例してカットオフ周波数が増加するローパスフィルタ」です。通常のローパスフィルタは、ノイズを抑えようとすると機敏な動きへ追随することができなくなってしまいますが、1€フィルタでは、<strong>機敏な動きに対してはノイズ抑制を緩くしてやることで、低速でのノイズを抑えつつ機敏な動きへの追従性も確保する</strong>ことができます。</p>
<p>下記の3つの項目を調整することができます。</p>
<ul>
<li>fc0: 速さゼロにおけるカットオフ周波数。<strong>これが小さな値であるほど、低速でのノイズが抑制されます</strong>。</li>
<li>Beta: 速さに比例してカットオフ周波数がどれだけ増加するか。<strong>これが大きな値であるほど、機敏な動きに追随できます</strong>。</li>
<li>fcv: 速さに対するカットオフ周波数。速さに対しては、この値で指定されるカットオフ周波数を持つ通常のローパスフィルタが適用されます。</li>
</ul>
<h6 id="_21">スムージングの強度の調整手順</h6>
<ul>
<li>
<p>キャプチャを開始し、まず、体を動かさず真っすぐ立った時のノイズを観察します。ノイズが気になる場合は、fc0を減らします。</p>
</li>
<li>
<p>ノイズが十分抑えられたら、次に、キャプチャ目的に応じた適当な速さで体を動かします。動きに追随できていない場合は、Betaを増やします。</p>
</li>
</ul>
<h3 id="_22">負荷対策</h3>
<p>使用するPC環境と用途にあわせて、負荷を下げるよう設定します。</p>
<p><img alt="Settings-General+Performance" src="{{ site.url }}{{ site.baseurl }}/assets/images/Settings-General+Performance.png" />  </p>
<h4 id="_23">フレームレートの確認</h4>
<ul>
<li>「Settings &gt; Performance &gt; Show frame rate」を<strong>オン</strong>にすると、現在のフレームレートがウィンドウ下部に表示されます。 </li>
</ul>
<h4 id="cpugpu">CPUよりGPU</h4>
<p>MocapForAllではAIを使って人の姿勢を推定しています。AIの計算は、多くの場合、CPUよりGPUを使う方が高速です。
「Settings &gt; General &gt; Run DNN on」から、CPUを使うかGPUを使うかを選択できます。また、GPUが複数ある場合は、どのGPUを使うかも選択できます。</p>
<p>GPUを使う場合、二つの選択肢があります。TensorRTは環境準備が大変かつ読み込み時間が長く、それでいて見返りが少ないため、多くの場合「<strong>GPU_DriectML</strong>」 の使用をおすすめします。</p>
<ul>
<li>GPU_DriectML
  DirectMLは、DirectX12対応GPUでGPUアクセラレーションを可能にします。使用可能なハードウェアの例は次の通りです。</li>
<li>NVIDIA Kepler（GTX 600シリーズ）以降</li>
<li>AMD GCN 1st Gen（Radeon HD 7000シリーズ）以降</li>
<li>GPU_TensorRT
  TensorRTは、サポートされているNVIDIA製GPUでGPUアクセラレーションを可能にします。
  これを使用するには、CUDA、cuDNN、およびTensorRTをインストールした上で、「Appendix4_TensorRT_mode」をインストールする必要があります。詳細は、<a href="#temsorrtのインストール">TemsorRTのインストール手順</a>を参照してください。</li>
</ul>
<h4 id="_24">速度優先モード</h4>
<p>「Settings &gt; General &gt; Capture body」から、何を優先して実行するかを設定できます。</p>
<ul>
<li>多くの用途で「<strong>Speed</strong>」をおすすめします。</li>
<li>ノートPCなど性能が低いPCを利用している場合や、非常に重いVRアプリと併用する場合などは、「Speed+」をおすすめします。</li>
<li>映像用途等で特に精度よくモーションキャプチャしたい場合には、「Precision」モードを使用します。「<a href="#付録（省略可）">付録</a>」のAppendix1のインストールが必要です。</li>
</ul>
<h4 id="_25">描画を減らす</h4>
<p>下記の設定により、MocapForAll上での描画を減らし負荷を削減することができます。</p>
<ul>
<li>「Settings &gt; General &gt; Character」で「<strong>Empty</strong>」キャラクターを選択します。</li>
<li>「Settings &gt; General &gt; Map」で「<strong>Minimum</strong>」マップを選択します。</li>
<li>「Settings &gt; Performance &gt; Set screen percentage to」を<strong>オン</strong>にし、小さな値 (たとえば 30%) を設定します。
  または、「Settings &gt; Performance &gt; Render the viewport」を<strong>オフ</strong>にします。</li>
</ul>
<h4 id="_26">フレームレートの上限を設定する</h4>
<ul>
<li>「Settings &gt; Performance &gt; Limit framerate to:」を<strong>オン</strong>にし、目標とするフレームレート (たとえば 30FPS) を設定します。 
    MocapForAllはこのフレームレートを上限として動作します。</li>
</ul>
<h1 id="2_1">使い方２：キャプチャしたモーションの利用編</h1>
<h2 id="vmtsteamvr">VMTによるSteamVR連携</h2>
<p>gpsnmeajp様が作成した「<a href="https://gpsnmeajp.github.io/VirtualMotionTrackerDocument/">Virtual Motion Tracker</a>」と組み合わせて使用することで、MocapForAllでキャプチャした結果を仮想トラッカーとしてSteamVRで使用することができます。
仮想トラッカーを用いることで、例えばVRChatでフルボディトラッキングを実現することができます。</p>
<p>Virtual Motion Tracker は MocapForAll とは別のプログラムであることに注意してください。Virtual Motion Tracker と MocapForAll を一緒に利用して発生したいかなる問題についても、Virtual Motion Tracker の作成者様に問い合わせしないでください。</p>
<h3 id="virtual-motion-tracker">Virtual Motion Trackerのインストール</h3>
<ul>
<li>Virtual Motion Tracker を <a href="https://gpsnmeajp.github.io/VirtualMotionTrackerDocument/setup/">セットアップ手順</a> の通りにインストールします。</li>
<li>後述の<a href="#steamvrとmocapforallの座標合わせ">SteamVRとMocapForAllの座標合わせ</a>で<a href="#自動調整機能を使う場合">自動調整機能を使う場合</a>は、Virtual Motion Trackerは MocapForAll向けに改造したバージョンを使用する必要があります。<a href="https://github.com/KenjiAsaba/VirtualMotionTracker/releases">こちらからダウンロード</a>し、上記のセットアップ手順と同じ手順でインストールしてください。また、MocapForAllはv1.10以降を使用する必要があります。</li>
<li>一部のアプリケーションでVMTを利用するには、<a href="https://gpsnmeajp.github.io/VirtualMotionTrackerDocument/advanced/#how-to-set-the-controller-bainding">コントローラーバンディングの設定</a>を行う必要があります。</li>
</ul>
<h3 id="mocapforallvmt">MocapForAllのVMT送信設定</h3>
<p><img alt="Settings-DataExport-VMT-SteamVR" src="{{ site.url }}{{ site.baseurl }}/assets/images/Settings-DataExport-VMT-SteamVR.png" />  </p>
<ul>
<li>「Settings &gt; Data export &gt; Destination IP address for VMT and VMC」を下記の通り設定します</li>
<li>送信先が同じPCの場合：「127.0.0.1」</li>
<li>送信先が別のPCの場合： 送信先のPCのIPアドレス<ul>
<li>コマンドプロンプトを開いて、"ipconfig /all" で確認できます</li>
<li>MocapForAllとSteamVRを別PCで実行することで、処理の負荷を分散させ、快適にVRゲームをプレイすることができます</li>
</ul>
</li>
<li>「Settings &gt; Data export &gt; VMT protocol &gt; Send tracking points」をオンにします</li>
<li>「Settings &gt; Data export &gt; VMT protocol &gt; Send tracking points」のポートを「39570」にします</li>
<li>「Settings &gt; Data export &gt; VMT protocol &gt; Send tracking points &gt; Tracking points to be sent」の下の必要な箇所をオンにします</li>
<li>例えばVRChatで使用する場合は、「Pelvis」と「Feet」をオンにします</li>
<li>それぞれの左横の「&gt;」をクリックすると、仮想トラッカー位置のオフセットを調整できます。</li>
</ul>
<p>下記設定については、好みに応じてオンオフを決定してください。まずはオンで試し、動きにこだわりたい場合にオフを試すことをおすすめします。</p>
<ul>
<li>
<p>「Settings &gt; Data export &gt; VMT protocol &gt; Send tracking points &gt; As relative position to HMD」</p>
</li>
<li>
<p><strong>オフ</strong>にすると、各部位の実際のトラッキング位置が、そのまま各部位の仮想トラッカーの位置として使われます。</p>
<ul>
<li>ヘッドマウントディスプレイに対する、各部位の仮想トラッカーの位置情報の<strong>遅延がそのまま見えてしまう</strong>状態になります。<br />
  (例えば歩き出しは、頭だけが先行し、残りの部位が後からついてくるような見た目になります)</li>
<li>後述の<a href="#steamvrとmocapforallの座標合わせ">SteamVRとMocapForAllの座標合わせ</a>で、<strong>スケールと位置を適切に設定</strong>する必要があります。
  (スケールが一致していない場合、部屋の中での移動に応じてヘッドマウントディスプレイと各部位の水平方向の位置がずれます)</li>
</ul>
</li>
<li>
<p><strong>オン</strong>にすると、頭と各部位の相対位置が、ヘッドマウントディスプレイと各部位の相対位置に変換されて仮想トラッカーの位置に使われます。</p>
<ul>
<li>ヘッドマウントディスプレイに対して、各部位の仮想トラッカーの位置情報の<strong>遅延が目立ちにくくなります</strong>。<br />
  (例えば歩き出しは、頭に連れて各部位が横滑りするような見た目になります)</li>
<li>後述の<a href="#steamvrとmocapforallの座標合わせ">SteamVRとMocapForAllの座標合わせ</a>で、<strong>スケールは適当でOK、位置の設定は不要</strong>になります。</li>
</ul>
</li>
</ul>
<h3 id="steamvrmocapforall">SteamVRとMocapForAllの座標合わせ</h3>
<p>SteamVRでトラッキングされているHMDおよびコントローラの座標系と、MocapForAllでトラッキングされている体の位置の座標系は、そのままでは一致しません。これらを一致させるよう、手動または自動で調整する必要があります。</p>
<h4 id="_27">手動で調整する場合</h4>
<ul>
<li>準備</li>
<li>MocapForAll ウィンドウ上部の「Start capture」をクリックし、モーションのキャプチャを開始します。</li>
<li>
<p>ヘッドマウントディスプレイを被り、SteamVR Homeを含むSteamVRで動いているアプリを終了し、SteamVRのデフォルト画面で仮想トラッカーを視認できる状態にします。</p>
</li>
<li>
<p>スケールの調整</p>
</li>
<li>MocapForAllで<ul>
<li>「Settings &gt; Data export &gt; VMT protocol &gt; Send tracking points &gt; Tracking points to be sent」の下の「Head」をオンにします。</li>
<li>「Settings &gt; Data export &gt; VMT protocol &gt; Send tracking points &gt; As relative position to HMD」をオフにします。</li>
</ul>
</li>
<li>
<p>自分の目線の高さと、「Head」の仮想トラッカーの高さが一致するように、「Settings &gt; Coordinates &gt; Scale &gt; Upper body」および「Settings &gt; Coordinates &gt; Scale &gt; Lower body」の値を設定します。「Upper body」と「Lower body」は基本的に同じ値にします。</p>
</li>
<li>
<p>回転の調整</p>
</li>
<li>MocapForAllで<ul>
<li>「Settings &gt; Data export &gt; VMT protocol &gt; Send tracking points &gt; Tracking points to be sent」の下の「Feet」をオンにします。</li>
<li>「Settings &gt; Data export &gt; VMT protocol &gt; Send tracking points &gt; As relative position to HMD」をオンにします。</li>
</ul>
</li>
<li>
<p>自分の足を前後に動かし、その動く向きが足元の「Feet」の仮想トラッカーの動く向きと一致するように、「Settings &gt; Coordinates &gt; Coord. rotation」の値を設定します。</p>
</li>
<li>
<p>位置の調整</p>
</li>
<li>
<p>MocapForAllで</p>
<ul>
<li>「Settings &gt; Data export &gt; VMT protocol &gt; Send tracking points &gt; Tracking points to be sent」の下の「Feet」をオンにします。</li>
<li>「Settings &gt; Data export &gt; VMT protocol &gt; Send tracking points &gt; As relative position to HMD」をオフにします。</li>
</ul>
</li>
<li>
<p>自分の足の位置と「Feet」の仮想トラッカーの位置が一致するよう、「Settings &gt; Coordinates &gt; Origin position」の値を設定します。</p>
</li>
</ul>
<h4 id="_28">自動調整機能を使う場合</h4>
<p><a href="#virtual-motion-trackerのインストール">Virtual Motion Trackerのインストール</a>に記載の通り、この機能を使うには、Virtual Motion Trackerが<a href="https://github.com/KenjiAsaba/VirtualMotionTracker/releases">MocapForAll向けに改造したバージョン</a>である必要があります。また、MocapForAllはv1.10以降を使用する必要があります。</p>
<ul>
<li>VMT Manager および 他のポート39571を使用するアプリを終了します。</li>
<li>「Settings &gt; Data export &gt; VMT protocol &gt; Send tracking points」をオンにします。</li>
<li>ヘッドマウントディスプレイを被り、SteamVRが起動している状態にします。</li>
<li>SteamVRとMocapForAllの両方でトラッキングが成立する位置に立ちます。</li>
<li>MocapForAllで、ウィンドウ上部の「Align coord. to VR」をクリックします。</li>
<li>適当に歩き回ります。しばらくすると、自動的に「Settings &gt; Coordinates」の値が更新され、SteamVRとMocapForAllの座標が一致した状態になります。</li>
</ul>
<!-- ![Settings-DataExport-VMT-SteamVR-Align]({{ site.url }}{{ site.baseurl }}/assets/images/Settings-DataExport-VMT-SteamVR-Align.gif)　　 -->
<p><img alt="" loading="lazy" src="../images/Settings-DataExport-VMT-SteamVR-Align.gif" /></p>
<h2 id="vmc">VMCプロトコルによるアプリ連携</h2>
<h3 id="vrm">VRMモデル読み込み</h3>
<ul>
<li>VMCプロトコル連携先と同じVRMモデルを読み込みます。<br />
  VRMモデルを読み込むには、キャプチャを停止した状態で、VRMファイルをMocapForAllのウィンドウにドラッグ&amp;ドロップしてください。  </li>
</ul>
<p><img src="{{ site.url }}{{ site.baseurl }}/assets/images/Settings-General-Character-VRM.gif" alt="Settings-General-Character-VRM" style="zoom:50%;" />　　</p>
<h3 id="_29">モーションデータの送信</h3>
<p><img alt="Settings-DataExport-VMC" src="{{ site.url }}{{ site.baseurl }}/assets/images/Settings-DataExport-VMC.png" />　　</p>
<ul>
<li>「Settings &gt; Data export &gt; Destination IP address for VMT and VMC」を下記の通り設定します</li>
<li>送信先が同じPCの場合：「127.0.0.1」</li>
<li>送信先が別のPCの場合： 送信先のデバイスのIPアドレス</li>
<li>「Settings &gt; Data export &gt; VMC protocol &gt; Send bones」をオンにします</li>
<li>「Settings &gt; Data export &gt; VMC protocol &gt; Send bones」のポートを、送信先のポートに合わせて設定します</li>
</ul>
<p>ボーン（/VMC/Ext/Bone/Pos）としてではなく、トラッカー（/VMC/Ext/Tra/Pos）としてデータを送信したい場合は、下記を設定します。<br />
（例えば、VirtualMotionCaptureにデータを送信するにはこの設定が必要です）</p>
<ul>
<li>「Settings &gt; Data export &gt; VMC protocol &gt; Send bones &gt; As trackers (/VMC/Ext/Tra/Pos) 」をオンにします</li>
</ul>
<h3 id="_30">表情モーフデータの受信・送信</h3>
<p>表情モーフデータを受信するには、下記の通り設定します。</p>
<ul>
<li>「Settings &gt; Data export &gt; VMC protocol &gt; Receive facial morphs」をオンにします</li>
<li>「Settings &gt; Data export &gt; VMC protocol &gt; Receive facial morphs」のポートを、送信元のアプリが指定している送信先ポートに合わせて設定します</li>
<li>「Settings &gt; Data export &gt; VMC protocol &gt; Receive facial morphs &gt; From other device」を下記の通り設定します。</li>
<li>送信元が同じPCの場合：オフ</li>
<li>送信元が別のデバイスの場合：オン</li>
</ul>
<p>受信した表情モーフデータは、<a href="#モーションデータの送信">モーションデータの送信</a>の設定がされていれば、そのまま送信されます。</p>
<h2 id="bvh">BVH形式での書き出し</h2>
<h3 id="vrm_1">ボーン構造はVRM準拠</h3>
<p>MocapForAll上でVRMモデルにアニメーションをリターゲットした上で、BVH形式でアニメーションをエクスポートするしくみとしています。<br />
そのため、BVH形式でのデータ書き出し時は、自動的にVRMを使用するモードに切り替わります。</p>
<p>VRMモデルをお持ちでない場合は、実際にモデルをロードせずに、「Settings &gt; General &gt; Character」で「VRM runtime load」を選択してください。<br />
ダミーのVRMモデルがバックグラウンドで使用されます。</p>
<h3 id="bvh_1">BVH形式での書き出し方法</h3>
<!-- ![Settings-DataExport-BVH]({{ site.url }}{{ site.baseurl }}/assets/images/Settings-DataExport-BVH.gif) -->
<p><img alt="" loading="lazy" src="../images/Settings-DataExport-BVH.gif" /></p>
<ul>
<li>「Settings &gt; Data export &gt; Record to BVH file」を有効にします。</li>
<li>「Settings  &gt; General &gt; Character」が「VRM runtime load」に自動的に設定されます。</li>
<li>「Start capture」をクリックすると、BVH形式でのデータ保存が開始されます。</li>
<li>「Stop capture」をクリックすると、最終的なBVHファイルが生成されます。</li>
<li>無料試用版の場合は、300フレーム経過時点で自動的にBVHファイルが生成され、データ保存が停止されます。</li>
</ul>
<h3 id="_31">長さの単位はメートル</h3>
<p>生成されるBVHファイルのボーンの長さの単位はメートルとしています。読み込み先のアプリケーションで単位を適切に設定してください。</p>
<h2 id="ue4-ue5-unity">UE4, UE5, Unityへのデータ連携具体例</h2>
<h3 id="vmt">VMTプロトコルでの直接連携プラグイン</h3>
<p>VMTプロトコルを用いて、（Virtual Motion TrackerとSteamVRは使わずに）UnrealEngine4, UnrealEngine5, Unityへ直接データを連携するためのプラグインを<a href="https://booth.pm/ja/items/3026430">こちら</a>で公開しています。</p>
<p>使い方の詳細は下記をご覧ください。</p>
<ul>
<li><a href="https://github.com/Akiya-Research-Institute/MocapForAll-Receiver-Plugin-for-UE4/wiki">UE4版データ受信プラグインの使い方</a></li>
<li><a href="https://github.com/Akiya-Research-Institute/MocapForAll-Receiver-Plugin-for-UE5/wiki">UE5版データ受信プラグインの使い方</a></li>
<li>Unity版：  MocapForAllで下記の通り設定します</li>
<li>「Settings &gt; Data export &gt; Destination IP address for VMT and VMC」を下記の通り設定します<ul>
<li>送信先が同じPCの場合：「127.0.0.1」</li>
<li>送信先が別のPCの場合： 送信先のPCのIPアドレス（コマンドプロンプトを開いて、"ipconfig /all" で確認できます）</li>
</ul>
</li>
<li>下記の何れかを設定します。<ul>
<li>「Settings &gt; Data export &gt; VMT protocol &gt; Send bones」をオンにし、ポートを送信先に合わせて設定します</li>
<li>「Settings &gt; Data export &gt; VMT protocol &gt; Send tracking points」をオンにし、ポートを送信先に合わせて設定します</li>
</ul>
</li>
</ul>
<h3 id="vmc4ueevmc4u">VMC4UE、EVMC4Uによる連携</h3>
<ul>
<li><a href="#vmcプロトコルによるアプリ連携">VMCプロトコルによるアプリ連携</a>に記載の通り、MocapForAllの設定を行います。</li>
<li>VMC4UE</li>
<li>https://github.com/HAL9HARUKU/VMC4UE/wiki に記載の「UE4 の使い方」の通りUE4の設定を行い、UE4Editor上で実行します。（最後の「VirtualMotionCapture の使い方」は不要）</li>
<li>EVMC4U</li>
<li>https://github.com/gpsnmeajp/EasyVirtualMotionCaptureForUnity/wiki/How-to-use#externalreceiverpack%E3%82%92%E4%BD%BF%E3%81%86%E5%A0%B4%E5%90%88%E3%81%8B%E3%82%93%E3%81%9F%E3%82%93 に記載の「0. Unityを準備する」から「4. 再生して実行」を実施します。</li>
</ul>
<h2 id="_32">共有メモリへの書き出し</h2>
<p>キャプチャした体の動きと表情の生データを共有メモリに出力することができます。</p>
<h3 id="_33">共有メモリへの書き出しのオンオフ</h3>
<ul>
<li>「Settings &gt; Data export &gt; Shared Memory &gt; Export to shared memory」を有効にします。</li>
</ul>
<h3 id="_34">出力先の共有メモリ名の変更</h3>
<ul>
<li>「Settings &gt; Data export &gt; Shared Memory &gt; Names of shared memories」に設定した名前の共有メモリに、データが書き出されます。</li>
</ul>
<h3 id="_35">出力されるデータのフォーマット</h3>
<ul>
<li>最初の1バイトは、データが更新される度に+1される（255の次は0に戻る）カウンタです。</li>
<li>次の4バイトは、残りのデータのバイト単位での長さをint型で表した値です。</li>
<li>残りは、4バイトのfloat型が繰り返されます。</li>
</ul>
<h4 id="body">Body</h4>
<p><img alt="DataFormat-SharedMemory-Body" src="{{ site.url }}{{ site.baseurl }}/assets/images/DataFormat-SharedMemory-Body.png" /></p>
<h4 id="hand">Hand</h4>
<p>Bodyのデータと同様の形式で15個のボーンの向きと位置が出力されます。ボーンの並びは下記の通りです。</p>
<p><img src="{{ site.url }}{{ site.baseurl }}/assets/images/DataFormat-SharedMemory-Hand.png" alt="DataFormat-SharedMemory-Hand" style="zoom:60%;" /> </p>
<h4 id="face">Face</h4>
<p>468個の顔のランドマークについて、位置情報のみが出力されます。位置は、顔の範囲にトリミングされたカメラ画像中でのピクセル単位でのXY座標に加え、それと同じスケールでの奥行方向の推定位置をZ座標とした3次元の値で表されます。</p>
<p><img src="{{ site.url }}{{ site.baseurl }}/assets/images/DataFormat-SharedMemory-Face1.png" alt="DataFormat-SharedMemory-Face1" style="zoom: 65%;" /> </p>
<p>各ランドマークが顔のどこに対応するかは、下記画像を拡大して確認してください。</p>
<p><img src="{{ site.url }}{{ site.baseurl }}/assets/images/DataFormat-SharedMemory-Face.jpg" alt="DataFormat-SharedMemory-Face" style="zoom: 10%;" /> </p>
<h4 id="eye">Eye</h4>
<p>Faceのデータと同様の形式で、瞳について5点、まぶたについて71点の位置情報が出力されます。</p>
<h3 id="_36">共有メモリからの値の取得の実装例</h3>
<p>共有メモリに書き込まれたデータをUnityで読み取りGameObjectに反映するサンプルプロジェクトを<a href="https://github.com/Akiya-Research-Institute/MocapForAll-SharedMemory-Plugin-for-Unity">こちら</a>で公開しています。</p>
<h1 id="3">使い方３：その他の設定編</h1>
<h2 id="_37">手と顔のキャプチャ</h2>
<ul>
<li>「Settings &gt; General &gt; Capture hand」をオンにすると、指の動きをキャプチャします</li>
<li>「Settings &gt; General &gt; Capture face」をオンにすると、顔の表情をキャプチャします</li>
</ul>
<p>上記はいずれも実験的な機能です。処理負荷が高いこと、精度が低いことに注意してください。</p>
<h3 id="_38">キャプチャ時のトリミングのサイズ</h3>
<p>「Settings &gt; Advanced &gt; Cropping size for hand」「Cropping size for face」から、手と顔のキャプチャ時に画像を切り抜いてAIへの入力とする際のサイズを設定できます。人によって手や顔の大きさが異なるため、この値を調整すると精度が向上することがあります。</p>
<h3 id="_39">手のキャプチャの動作モード</h3>
<p>「Settings &gt; General &gt; Capture hand」の右のプルダウンから、動作モードを変更できます。</p>
<ul>
<li>「Full」：処理負荷が少し高く、精度が高いモードです。</li>
<li>「Lite」：処理負荷が少し低く、精度が低いモードです。</li>
<li>「Legacy」：v1.13以前に使用していたAIで動作します。後方互換のためのものです。</li>
</ul>
<h3 id="_40">顔のモーフターゲット名の設定</h3>
<p>VRM モデルを使用している場合にのみ、顔のモーフターゲット名を指定することができます。</p>
<ul>
<li>「Settings &gt; Advanced &gt; Specify facial morph target names」をオンにします</li>
<li>各モーフターゲットの名前を入力します。</li>
</ul>
<h2 id="_41">キャラクターへの視点の追随</h2>
<ul>
<li>「Settings &gt; General &gt; Look at character」をオンにすると、視点がキャラクターの動きに追随します</li>
</ul>
<h2 id="_42">トラッキング位置の表示・非表示</h2>
<ul>
<li>「Settings &gt; General &gt; Draw tracking points」で、トラッキング位置を表す黄色い四角形の表示をオンオフできます</li>
</ul>
<h2 id="_43">言語</h2>
<ul>
<li>画面右上の地球のアイコンから、使用する言語を設定できます。現状、日本語、英語、フランス語に対応しています。</li>
</ul>
<h2 id="_44">設定のリセット</h2>
<p>すべての設定をリセットするには、「C:\Users\【ユーザ名】\AppData\Local\MocapForAll」を削除します。</p>
<p>MocapForAllが何らかの原因で起動しなくなった場合、設定をリセットすると起動することがあります。</p>
<h2 id="_45">上半身のみへのモーション適用</h2>
<p>下記の設定により、キャラクターの上半身のみにモーションを適用するようになります。
- "Settings &gt; General &gt; Capture body &gt; Apply to lower body" をオフにする。</p>
<p>下半身は前フレームの位置で停止するので、必要に応じて "Settings &gt; Coordinates" で上半身と下半身の相対位置を調整してください。<br />
なお、内部の処理としては単に下半身へのモーションの適用を停止しているだけです。</p>
<h2 id="_46">録画した動画からモーションキャプチャする</h2>
<p>v1.12から、録画済みの動画を使ってモーションキャプチャできるようになりました。</p>
<h3 id="_47">使い方</h3>
<ul>
<li>MocapForAllのウィンドウ上部の「Add camera」の横の「▼」から、「Recorded video」を選択します。</li>
<li>「...」ボタンを押し、動画ファイルを選択します。</li>
<li>以降の基本的な使い方は、通常のウェブカメラと同様です。</li>
</ul>
<h3 id="_48">再生位置の挙動</h3>
<ul>
<li>動画は自動的にループ再生されます。</li>
<li>動画の再生位置は、「Start Capture」を押すと動画の先頭に戻ります。</li>
</ul>
<h3 id="tips">Tips</h3>
<ul>
<li>内部パラメータのカメラ校正用、外部パラメータのカメラ校正用、実際のモーションキャプチャ用で、分けて動画ファイルにしておくのがおすすめです。</li>
<li>内部パラメータの校正が終わったら「...」ボタンを押して外部パラメータ用の動画を開き、外部パラメータの校正が終わったら再度「...」ボタンを押して実際のモーションキャプチャ用の動画を開き、といった流れ。</li>
<li>再生された中身を解析してカメラ間で動きを同期させる仕組みは<strong>ない</strong>ので、モーションキャプチャ用の動画は、先頭から同時再生すれば動きが同期するよう、事前に編集しておく必要があります。撮影時に、カチンコや手を叩く音などで同期点を明確にしておくのがおすすめです。</li>
</ul>
<h2 id="_49">起動時にコマンドライン引数で動作を指定する</h2>
<p>v1.13から、下記の語句を引数に指定することで、起動時に特定の動作を実行させることができます。  </p>
<ul>
<li>「StartCapture」： 起動直後に「Start Capture」ボタンを押したときと同じ動作をします。</li>
<li>「LoadAllCameras」： 起動直後に「LoadAllCameras」ボタンを押したときと同じ動作をします。</li>
</ul>
<p>使用例：</p>
<p><img alt="App-Commandline-Args" src="{{ site.url }}{{ site.baseurl }}/assets/images/App-Commandline-Args.png" />  </p>
<h1 id="faq">FAQ</h1>
<h2 id="_50">カメラが認識されません</h2>
<ul>
<li><a href="#カメラ制御フレームワークの選択">カメラ制御フレームワークの選択</a>で、UE4 media playerを選択します</li>
<li>Image sizeから、異なるフォーマットを指定してみてください</li>
<li>カメラ制御フレームワークの選択で、Direct Showを選択します</li>
<li>カメラの仕様に基づき、適切なImage sizeを指定してください</li>
</ul>
<p>いずれでも動作しない場合、残念ですがMocapForAllでそのカメラは使用できません。</p>
<h2 id="_51">同機種のカメラ複数が認識されません</h2>
<p>同機種のカメラをPCに接続する場合、アプリ内のカメラ選択のプルダウン内に一部のカメラが表示されない（検出されない）問題があります。その場合は表示されないカメラデバイスにレジストリエディタから任意のFriendlyNameを設定すると認識される可能性があります。<br />
FriendlyNameの設定・変更の方法はお使いの環境により異なるため、検索等で各自お調べください。レジストリの書き換えとなるため、バックアップを取るなどの対策をお勧めします。  </p>
<h2 id="_52">仮想カメラが認識されません</h2>
<p>OBSに標準で入っている仮想カメラは機能しないことがわかっています。<a href="https://obsproject.com/forum/resources/obs-virtualcam.539/">OBS-VirtualCamプラグイン</a>をインストールし、<a href="#カメラ制御フレームワークの選択">カメラ制御フレームワークの選択</a>で、Direct Showを選択してください。</p>
<h2 id="_53">モノクロのカメラは使えますか</h2>
<p>いいえ、このアプリではモノクロのカメラは使用できません。RGBカメラをご使用ください。  </p>
<h2 id="ar">ARマーカが認識されません</h2>
<ul>
<li>カメラの画像が鏡像になっていないことを確認してください。</li>
<li>カメラの画像がARマーカに対してフォーカスが合っていることを確認してください。</li>
<li>カメラの画像内でARマーカが十分に大きく映っていることを確認してください。</li>
<li>ARマーカのサイズを大きく印刷すると解決するかもしれません</li>
<li>外部パラメータのカメラ校正においては、<a href="#マーカをうまく読み取れない場合">マーカをうまく読み取れない場合</a>を参照してください。</li>
</ul>
<h2 id="_54">外部パラメータのカメラ校正がうまくいきません</h2>
<p><a href="#マーカをうまく読み取れない場合">マーカをうまく読み取れない場合</a>を参照してください。</p>
<h2 id="_55">カメラ校正をしてもモーションキャプチャができません</h2>
<ul>
<li>キャプチャ開始時点は人が真っすぐ立っている画像でなければ認識できません。カメラの設置状況に合わせてカメラ画像を適切に回転してください。</li>
<li>カメラ校正が完了した二つ以上のカメラから全身が映ることを確認してください。</li>
<li>最終的なフレームレートが 4FPS 以下の場合、動作しません。<a href="#フレームレートの確認">フレームレートを確認</a>してください。</li>
</ul>
<h2 id="_56">複数人のキャプチャに対応していますか？</h2>
<p>いいえ、現在のところ1名のみのトラッキングが可能です。そのためカメラには原則1名のみが映るようにしてください。  </p>
<h2 id="vmt_1">VMTが動きません</h2>
<p>VMT Managerでエラーを確認してください。特に、<a href="https://gpsnmeajp.github.io/VirtualMotionTrackerDocument/trouble/#room-matrix-is-not-set">Room Matrixの設定</a>がされているか確認してください。</p>
<h2 id="vmt_2">VMTの動きがおかしいです</h2>
<p><a href="#steamvrとmocapforallの座標合わせ">SteamVRとMocapForAllの座標合わせ</a>が適切にされているか確認してください。</p>
<h2 id="_57">シリアルナンバーの入力欄がありません</h2>
<p>最新のMocapForAllをインストールしてください。バージョン1.0以降からHMDのシリアルナンバー入力は不要です。  </p>
<h2 id="mocapforall">MocapForAllと他のツールとの違い</h2>
<ul>
<li><a href="https://github.com/CMU-Perceptual-Computing-Lab/openpose/blob/master/doc/advanced/3d_reconstruction_module.md">OpenPose</a>： 基本的な実装方針は近いですが、ライセンスが大きく異なります。OpenPoseは基本的に"ACADEMIC OR NON-PROFIT ORGANIZATION NONCOMMERCIAL RESEARCH USE ONLY"です。</li>
</ul>
<h1 id="_58">既知のバグ</h1>
<h2 id="rtx30xx-tensorrt">RTX30xx シリーズで TensorRT モードが動作しません</h2>
<p>DirectMLモードを使ってください。</p>
<h1 id="_59">謝辞</h1>
<p>フランス語へ翻訳してくれた Gonzales kévin, "Raybox41130" 様に心から感謝します。</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2022 Akiya Research Institute, Inc. All Rights Reserved
          </div>
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://www.youtube.com/channel/UC7t4amWNvquSy_ODcGZ4R0g" target="_blank" rel="noopener" title="www.youtube.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/Akiya_Souken_VR" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://github.com/Akiya-Research-Institute" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tracking", "toc.integrate", "search.suggest", "search.highlight", "search.share", "header.autohide"], "translations": {"clipboard.copy": "\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u3078\u30b3\u30d4\u30fc", "clipboard.copied": "\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\s\\-\u3000\u3001\u3002\uff0c\uff0e]+", "search.placeholder": "\u691c\u7d22", "search.result.placeholder": "\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044", "search.result.none": "\u4f55\u3082\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f", "search.result.one": "1\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.other": "#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.one": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3082\u30461\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.other": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3042\u3068#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.term.missing": "\u691c\u7d22\u306b\u542b\u307e\u308c\u306a\u3044", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.fcfe8b6d.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.b1047164.min.js"></script>
      
    
  </body>
</html>